# GitHub Copilot カスタムインストラクション

このドキュメントは、Go-Shisha（シーシャSNSアプリ）でGitHub Copilotがレビュー、コード生成を行う際に参照するためのカスタムインストラクションです。

## 共通基本ルール

1. **応答言語**: 質問への回答は常に日本語で行ってください。
2. **確認メッセージ**: ルールを参照したことを示すため、回答の冒頭に「ルールを参照しました！」と表示してください。
3. **推論・想像の禁止**: 推論や想像で作業しない。事実に基づいて作業する。不明な点は確認を求める。
4. **コミットメッセージ言語**: コミットメッセージはConventional Commitsに従い日本語で記述する。type: 日本語説明の形式を使用する（例: `feat: 投稿作成機能を追加`, `fix: API認証エラーを修正`）
5. **テスト実行の効率化と検証**: 変更したファイルがある場合、まずテスト内容が修正内容を正しく検証できるかを確認してから、全体実行ではなく単体で実行して時間を省略する。必要に応じてテストケースを追加してから実行する
6. **Issue・PR内容のCLI確認徹底**: IssueやPRの内容・コメントを確認する際は、GitHubのWebページではなく必ずghコマンド（CLI）で確認する。作業効率・履歴管理のためWeb UIは原則使用しない。
7. **PRレビューコメント確認**: PR上でCopilotのレビューを確認する際は`gh api url/comments`でコメントを確認し、GitHubのWeb UIではなくCLIで効率的に対応する
8. **コミット粒度の細分化**: 複数ファイルをまとめてaddしてコミットするのではなく、論理的に関連する変更ごとに小分けしてコミットする。1つのコミットは1つの明確な目的を持つようにし、レビューしやすい粒度に保つ。具体的には `git add 特定ファイル` → `git commit` を繰り返し、一度に複数の無関係な変更をコミットしない
9. **ラベル付与の徹底**: IssueやPR作成時は必ず適切なラベルを紐づける。ラベルにより作業の種類（feature、bug、docs等）や優先度が明確になり、プロジェクト管理が効率化される
10. **PR作成の最適化**: テンプレートに従いつつ、Copilotがレビューしやすいよう重点レビュー箇所を明記する。変更の意図・影響範囲・テスト方針を具体的に記載し、レビュー効率を向上させる
11. **ルール管理**: 重要なベストプラクティスを発見した際は、基本ルールへの昇格も検討し、動的ルールセクションまたは基本ルールへの追加を提案する
12. **操作前の確認徹底**: gitコマンド（add、commit、push）やファイル削除、データベース操作など後戻りが困難な操作を実行する前は、必ずユーザーに内容と影響を説明して明示的な許可を求める。勝手に実行してはならない
13. **GitHub投稿時の署名**: ghコマンドでIssueやPRにコメントを投稿する際は、コメント末尾に必ず「*-- by Copilot*」の署名を追加する。ユーザーとCopilotの投稿を明確に区別するため
14. **設定ファイルの動作確認**: Linter設定、ビルド設定、CI設定等の設定ファイルを作成・変更した場合、必ず実行して動作確認してからコミットする。動作しない設定をコミットしてはならない
15. **コミット前の変更確認**: コミット前に必ず`git status`で変更ファイルを確認し、漏れがないかチェックする。意図しないファイルの除外やステージング忘れを防ぐ

## 本ドキュメントの役割と参照先

このファイルは「共通基本ルール」を主要なソースとして残します。プロジェクト内の領域別ルールは以下のファイルに分割しています。各ファイルは先頭に「参照確認メッセージ」の指示を含んでいます。

- `copilot-review.md` : PR / レビュー関連ルール（バッジ、レビュー方針など）
- `copilot-frontend.md` : Frontend 固有ルール（TypeScript、Storybook、コンポーネント設計）
- `copilot-backend.md` : Backend 固有ルール（Go、ビルド・テスト・DI 等）
- `copilot-vrt.md` : VRT（Visual Regression Testing）運用ルール

運用ルール:
- トップの共通ルールは唯一の「共通ソース」です。領域別ファイルは補足・運用手順を持ち、重複は避けてください。
- 各領域ファイルを参照したら、そのファイル名を明示した確認メッセージを回答冒頭に出すことをルール化します（例: `copilot-frontend.md のルールを参照しました！`）。

<!-- AUTO_RULES_START -->
<!-- 今後、重要なルールやベストプラクティスが自動で追加されます -->
<!-- AUTO_RULES_END -->
