basePath: /api/v1
definitions:
  go-shisha-backend_internal_models.AuthResponse:
    properties:
      user:
        $ref: '#/definitions/go-shisha-backend_internal_models.User'
    type: object
  go-shisha-backend_internal_models.CreatePostInput:
    properties:
      slides:
        items:
          $ref: '#/definitions/go-shisha-backend_internal_models.SlideInput'
        minItems: 1
        type: array
    required:
    - slides
    type: object
  go-shisha-backend_internal_models.CreateUserInput:
    properties:
      display_name:
        type: string
      email:
        type: string
      password:
        minLength: 12
        type: string
    required:
    - email
    - password
    type: object
  go-shisha-backend_internal_models.ErrorResponse:
    properties:
      error:
        type: string
    type: object
  go-shisha-backend_internal_models.Flavor:
    properties:
      color:
        type: string
      id:
        type: integer
      name:
        type: string
    type: object
  go-shisha-backend_internal_models.LoginInput:
    properties:
      email:
        type: string
      password:
        type: string
    required:
    - email
    - password
    type: object
  go-shisha-backend_internal_models.Post:
    properties:
      created_at:
        type: string
      id:
        type: integer
      is_liked:
        type: boolean
      likes:
        type: integer
      slides:
        items:
          $ref: '#/definitions/go-shisha-backend_internal_models.Slide'
        type: array
      user:
        $ref: '#/definitions/go-shisha-backend_internal_models.User'
      user_id:
        type: integer
    type: object
  go-shisha-backend_internal_models.PostsResponse:
    properties:
      posts:
        items:
          $ref: '#/definitions/go-shisha-backend_internal_models.Post'
        type: array
      total:
        type: integer
    type: object
  go-shisha-backend_internal_models.Slide:
    properties:
      flavor:
        $ref: '#/definitions/go-shisha-backend_internal_models.Flavor'
      image_url:
        type: string
      text:
        type: string
    required:
    - image_url
    type: object
  go-shisha-backend_internal_models.SlideInput:
    properties:
      flavor_id:
        type: integer
      image_url:
        type: string
      text:
        type: string
    required:
    - image_url
    type: object
  go-shisha-backend_internal_models.User:
    properties:
      description:
        type: string
      display_name:
        type: string
      email:
        type: string
      external_url:
        type: string
      icon_url:
        type: string
      id:
        type: integer
    type: object
  go-shisha-backend_internal_models.UsersResponse:
    properties:
      total:
        type: integer
      users:
        items:
          $ref: '#/definitions/go-shisha-backend_internal_models.User'
        type: array
    type: object
host: localhost:8080
info:
  contact:
    name: API Support
    url: https://github.com/illionillion/go-shisha
  description: |-
    シーシャSNSアプリケーションのバックエンドAPI
    このAPIはシーシャの投稿、ユーザー管理を行います
  title: Go-Shisha API
  version: "1.0"
paths:
  /auth/login:
    post:
      consumes:
      - application/json
      description: メールアドレスとパスワードでログインし、JWT（Cookie）を発行する
      parameters:
      - description: ログイン情報
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/go-shisha-backend_internal_models.LoginInput'
      produces:
      - application/json
      responses:
        "200":
          description: ログイン成功
          schema:
            $ref: '#/definitions/go-shisha-backend_internal_models.AuthResponse'
        "400":
          description: バリデーションエラー
          schema:
            $ref: '#/definitions/go-shisha-backend_internal_models.ErrorResponse'
        "401":
          description: 認証失敗
          schema:
            $ref: '#/definitions/go-shisha-backend_internal_models.ErrorResponse'
        "500":
          description: サーバーエラー
          schema:
            $ref: '#/definitions/go-shisha-backend_internal_models.ErrorResponse'
      summary: ログイン
      tags:
      - auth
  /auth/logout:
    post:
      description: Cookieを削除し、Refresh Tokenを無効化する
      produces:
      - application/json
      responses:
        "200":
          description: ログアウト成功
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: 認証失敗
          schema:
            $ref: '#/definitions/go-shisha-backend_internal_models.ErrorResponse'
        "500":
          description: サーバーエラー
          schema:
            $ref: '#/definitions/go-shisha-backend_internal_models.ErrorResponse'
      security:
      - BearerAuth: []
      summary: ログアウト
      tags:
      - auth
  /auth/me:
    get:
      description: 認証されたユーザーの情報を取得する
      produces:
      - application/json
      responses:
        "200":
          description: ユーザー情報
          schema:
            $ref: '#/definitions/go-shisha-backend_internal_models.AuthResponse'
        "401":
          description: 認証失敗
          schema:
            $ref: '#/definitions/go-shisha-backend_internal_models.ErrorResponse'
        "500":
          description: サーバーエラー
          schema:
            $ref: '#/definitions/go-shisha-backend_internal_models.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 現在のユーザー情報取得
      tags:
      - auth
  /auth/refresh:
    post:
      description: Refresh Tokenを使って新しいAccess Tokenを発行する
      produces:
      - application/json
      responses:
        "200":
          description: リフレッシュ成功
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: 認証失敗
          schema:
            $ref: '#/definitions/go-shisha-backend_internal_models.ErrorResponse'
        "500":
          description: サーバーエラー
          schema:
            $ref: '#/definitions/go-shisha-backend_internal_models.ErrorResponse'
      summary: アクセストークンのリフレッシュ
      tags:
      - auth
  /auth/register:
    post:
      consumes:
      - application/json
      description: 新しいユーザーを登録する
      parameters:
      - description: ユーザー登録情報
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/go-shisha-backend_internal_models.CreateUserInput'
      produces:
      - application/json
      responses:
        "201":
          description: 登録成功
          schema:
            $ref: '#/definitions/go-shisha-backend_internal_models.AuthResponse'
        "400":
          description: バリデーションエラー
          schema:
            $ref: '#/definitions/go-shisha-backend_internal_models.ErrorResponse'
        "409":
          description: メールアドレス重複
          schema:
            $ref: '#/definitions/go-shisha-backend_internal_models.ErrorResponse'
        "500":
          description: サーバーエラー
          schema:
            $ref: '#/definitions/go-shisha-backend_internal_models.ErrorResponse'
      summary: ユーザー登録
      tags:
      - auth
  /posts:
    get:
      consumes:
      - application/json
      description: 全ての投稿の一覧を取得します（総数付き）
      produces:
      - application/json
      responses:
        "200":
          description: 投稿一覧と総数
          schema:
            $ref: '#/definitions/go-shisha-backend_internal_models.PostsResponse'
        "500":
          description: サーバーエラー
          schema:
            additionalProperties: true
            type: object
      summary: 投稿一覧取得
      tags:
      - posts
    post:
      consumes:
      - application/json
      description: '新しい投稿を作成します（認証必須）。注意: slides内のflavor_idが無効な場合、そのスライドはFlavorなしで作成されます（エラーにはなりません）'
      parameters:
      - description: 投稿情報
        in: body
        name: post
        required: true
        schema:
          $ref: '#/definitions/go-shisha-backend_internal_models.CreatePostInput'
      produces:
      - application/json
      responses:
        "201":
          description: 作成された投稿
          schema:
            $ref: '#/definitions/go-shisha-backend_internal_models.Post'
        "400":
          description: バリデーションエラー
          schema:
            additionalProperties: true
            type: object
        "401":
          description: 認証エラー
          schema:
            additionalProperties: true
            type: object
        "500":
          description: サーバーエラー
          schema:
            additionalProperties: true
            type: object
      security:
      - BearerAuth: []
      summary: 投稿作成
      tags:
      - posts
  /posts/{id}:
    get:
      consumes:
      - application/json
      description: 指定されたIDの投稿情報を取得します
      parameters:
      - description: 投稿ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: 投稿情報
          schema:
            $ref: '#/definitions/go-shisha-backend_internal_models.Post'
        "400":
          description: 無効な投稿ID
          schema:
            additionalProperties: true
            type: object
        "404":
          description: 投稿が見つかりません
          schema:
            additionalProperties: true
            type: object
      summary: 投稿詳細取得
      tags:
      - posts
  /posts/{id}/like:
    post:
      consumes:
      - application/json
      description: 指定された投稿にいいねを追加します
      parameters:
      - description: 投稿ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: いいねが追加された投稿
          schema:
            $ref: '#/definitions/go-shisha-backend_internal_models.Post'
        "400":
          description: 無効な投稿ID
          schema:
            additionalProperties: true
            type: object
        "404":
          description: 投稿が見つかりません
          schema:
            additionalProperties: true
            type: object
      summary: 投稿にいいね
      tags:
      - posts
  /posts/{id}/unlike:
    post:
      consumes:
      - application/json
      description: 指定された投稿のいいねを取り消します
      parameters:
      - description: 投稿ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: いいねが取り消された投稿
          schema:
            $ref: '#/definitions/go-shisha-backend_internal_models.Post'
        "400":
          description: 無効な投稿ID
          schema:
            additionalProperties: true
            type: object
        "404":
          description: 投稿が見つかりません
          schema:
            additionalProperties: true
            type: object
      summary: 投稿のいいねを取り消す
      tags:
      - posts
  /users:
    get:
      consumes:
      - application/json
      description: 全てのユーザーの一覧を取得します（総数付き）
      produces:
      - application/json
      responses:
        "200":
          description: ユーザー一覧と総数
          schema:
            $ref: '#/definitions/go-shisha-backend_internal_models.UsersResponse'
        "500":
          description: サーバーエラー
          schema:
            additionalProperties: true
            type: object
      summary: ユーザー一覧取得
      tags:
      - users
  /users/{id}:
    get:
      consumes:
      - application/json
      description: 指定されたIDのユーザー情報を取得します
      parameters:
      - description: ユーザーID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: ユーザー情報
          schema:
            $ref: '#/definitions/go-shisha-backend_internal_models.User'
        "400":
          description: 無効なユーザーID
          schema:
            additionalProperties: true
            type: object
        "404":
          description: ユーザーが見つかりません
          schema:
            additionalProperties: true
            type: object
      summary: ユーザー詳細取得
      tags:
      - users
  /users/{id}/posts:
    get:
      consumes:
      - application/json
      description: 指定されたユーザーの全ての投稿を取得します（総数付き）
      parameters:
      - description: ユーザーID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: 投稿一覧と総数
          schema:
            $ref: '#/definitions/go-shisha-backend_internal_models.PostsResponse'
        "400":
          description: 無効なユーザーID
          schema:
            additionalProperties: true
            type: object
        "404":
          description: ユーザーが見つかりません
          schema:
            additionalProperties: true
            type: object
      summary: ユーザーの投稿一覧取得
      tags:
      - users
schemes:
- http
securityDefinitions:
  BearerAuth:
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
